Imports System.Data.Sql
Imports System.Data.SqlClient
Public Class Inf_Compras
    Public conexion As SqlConnection
    Sub Limpiarcampos()
        Txt_CodProducto.Text = ""
        Txt_CodProducto.Select()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Conexion = New SqlConnection("Data Source=DESKTOP-OM7MBFK\SQLEXPRESS ;Initial Catalog=Agrocomercial AVA ;Integrated Security=True")
        Conexion.Open()
        Dim comando As String = "select * from Compras Where Numero_Compra = '" & Txt_CodProducto.Text & "'"
        Dim da As New SqlDataAdapter
        Dim dt As New DataTable
        da = New SqlDataAdapter(comando, Conexion)
        da.Fill(dt)
        If Txt_CodProducto.Text.Length = 0 Then
            MsgBox("Por favor ingrese el codigo de producto")
        Else
            If IsNumeric(Txt_CodProducto.Text) Then


                Try
                    If dt.Rows.Count <> 0 Then
                        Me.ComprasTableAdapter.Buscar_Compra(Me.Agrocomercial_AVADataSet.Compras, Txt_CodProducto.Text)
                    Else
                        MsgBox("La Compra no existe")
                        Txt_CodProducto.Clear()
                    End If
                Catch ex As Exception

                End Try

            End If

        End If
    End Sub

    Private Sub Inf_Compras_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        'TODO: esta línea de código carga datos en la tabla 'Agrocomercial_AVADataSet.Compras' Puede moverla o quitarla según sea necesario.
        Me.ComprasTableAdapter.Fill(Me.Agrocomercial_AVADataSet.Compras)

        Limpiarcampos()
    End Sub

    Private Sub DateTimePicker1_ValueChanged(sender As Object, e As EventArgs) Handles Dtp_Fecha.ValueChanged
        ' Fecha del control DateTimePicker
        '
        Dim fecha As String =
            String.Format("{0:#MM\/dd\/yyyy#}", Dtp_Fecha.Value)

        ' Establecemos el filtro
        Me.ComprasBindingSource.Filter = "Fecha_Compra = " & fecha

    End Sub

    Private Sub Btn_MostrarTodo_Click(sender As Object, e As EventArgs) Handles Btn_MostrarTodo.Click
        Me.ComprasBindingSource.Filter = True
        Me.ComprasTableAdapter.Fill(Me.Agrocomercial_AVADataSet.Compras)
        Limpiarcampos()
    End Sub

    Private Sub Txt_CodProducto_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Txt_CodProducto.KeyPress
        SoloNumeros(e)
    End Sub
End Class
